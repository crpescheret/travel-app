<script type="text/javascript">var tripId = <%= @trip.id %>;
</script>

<div class="container">
  <div class="row">
    <div class="col s12 m9 l12">

      <div ng-app="app">
        <div ng-controller="flightsCtrl" ng-init="setup()">
          <h1>Add New Flight</h1>

          <ul class="collapsible" data-collapsible="accordion">
            <li>
              <div class="collapsible-header"><i class="material-icons">search</i>Search for Flights</div>
               <div class="collapsible-body">
                  <div class="container">
                    <div class="row">
                      <form class="col s12">
                        <div class="row">
                          <div class="input-field col s6">
                            <input id="origin" type="text" ng-model="origin"></input>
                            <label for="origin">Origin</label>
                          </div>
                          <div class="input-field col s6">
                            <input id="destination" type="text" ng-model="destination"></input>
                            <label for="destination">Destination</label>
                          </div>
                        </div>
                        <div>
                          <input ng-model="date" placeholder="YYYY-MM-DD"></input>
                          <label>Date</label>
                        </div>
                        <br>
                        <div>
                          <input type="submit" class="btn btn-default" value="Search" ng-click="searchFlights(origin, destination, date)"></input>
                        </div>
                  </form>
                  <br>
                  </div>

                  <div>
                    <table>
                      <thead>
                        <th>Airline</th>
                        <th>Flight No.</th>
                        <th>Departure Time</th>
                        <th>Arrival Time</th>
                        <th>Price</th>
                        <th>Add</th>
                      </thead>
                      <tbody ng-repeat="result in results">
                        <tr>
                          <td>{{ result.carrier}}</td>
                          <td>{{ result.flightNumber}}</td>
                          <td>{{ result.departureTime | date: 'medium' }}</td>
                          <td>{{ result.arrivalTime | date: 'medium' }}</td>
                          <td>{{result.price}}</td>
                          <td><a href="/trips/<%=params[:trip_id]%>/flights"
                             class="waves-effect waves-light btn" 
                             ng-click="addFlight(result.carrier, 
                                                 result.flightNumber, 
                                                 result.departureTime, 
                                                 result.arrivalTime, 
                                                 result.price)">Add</a></td>
                        </tr>
                      </tbody>
                    </table>
                  </div>
                </div>
            </li>

            <li>
              <div class="collapsible-header"><i class="material-icons">mode_edit</i>Add New Flight</div>
                <div class="collapsible-body container" style="margin-top: 20px; margin-bottom: 50px">
                  <!-- <form>
                    <div>
                      <input ng-model="newAirline"></input>
                      <label>Airline</label>
                    </div>
                    <div>
                      <input ng-model="newFlightNumber"></input>
                      <label>Flight Number</label>
                    </div>
                    <div>
                      <input ng-model="newDeparture" type="date" class="datepicker"></input>
                      <label>Departure</label>
                    </div>
                    <div>
                      <input ng-model="newArrival" type="date" class="datepicker"></input>
                      <label>Arrival</label>
                    </div>
                    <div>
                      <input ng-model="newPrice"></input>
                      <label>Price</label>
                    </div>
                    <div>
                      <input class="with-gap" ng-model="flightDirection" value="departing" name="group1" type="radio" id="test1" />
                      <label for="test1">Departing</label>
                    </div>
                    <div>
                      <input class="with-gap" ng-model="flightDirection" value="arriving" name="group1" type="radio" id="test2" />
                      <label for="test2">Arriving</label>
                    </div>
                    <a href="/trips/<%=params[:trip_id]%>/flights"class="waves-effect waves-light btn" ng-click="addFlight(newAirline, newFlightNumber, newDeparture, newArrival, newPrice, flightDirection)">Add</a>
                  </form> -->

                  <%= form_tag "/trips/#{params[:trip_id]}/flights", {method: :post} do %>
                    <div>
                      <%= label_tag :airline %>
                      <%= text_field_tag :airline %>
                    </div>
                    <div>
                      <%= label_tag :flight_number %>
                      <%= text_field_tag :flight_number %>
                    </div>
                    <div>
                      <%= label_tag :depart_time %>
                      <%= text_field_tag :depart_time %>
                    </div>
                    <div>
                      <%= label_tag :arrive_time %>
                      <%= text_field_tag :arrive_time %>
                    </div>
                    <div>
                      <%= label_tag :price %>
                      <%= text_field_tag :price %>
                    </div>
                    <div>
                      <%= radio_button_tag(:flight_direction, "departing") %>
                      <%= label_tag(:departing, "Departing?") %>
                    </div>
                    <div>
                      <%= radio_button_tag(:flight_direction, "arriving") %>
                      <%= label_tag(:arriving, "Arriving?") %>
                    </div>
                    <br>
                    <div>
                      <%= hidden_field_tag :trip_id, params[:trip_id] %> 
                      <%= submit_tag "Add", class: "btn btn-default" %>
                    </div>
                  <% end %>
                  <br>
                </div>
            </li>
          
          </ul>
        </div>
      </div>

    </div>
  </div>
</div>